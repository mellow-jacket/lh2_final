

-====================================================================-
|          LH2 TRANSFER SIMULATION - COMPLETE EXAMPLE               |
-====================================================================-

======================================================================
 PRESSURE-DRIVEN TRANSFER SIMULATION
======================================================================

Scenario: Trailer to Dewar Transfer (Pressure-Driven)
  - 17,000 gallon horizontal trailer (supply)
  - 3,300 gallon vertical dewar (receiver)
  - Vaporizer provides driving pressure
  - Automatic vent control

Initial Conditions:
  Supply Tank:
    - Liquid mass: 1148.6 kg
    - Initial fill: 90.0%
    - Temperature: 21.0 K
    - Pressure: 1.50 bar
  End Tank:
    - Liquid mass: 127.6 kg
    - Height: 5.7 m
    - Initial fill: 10.0%

Running simulation...

Simulation Summary:
  Total time: 3600.0 s (60.00 min)
  Time steps: 4020
  Success: True
  Message: The solver successfully reached the end of the integration interval.
  Function evaluations: 12880

Mass Transfer:
  Supply Tank initial: 1151.6 kg
  Supply Tank final: 249.7 kg
  Mass transferred: 901.9 kg
  End Tank initial: 150.6 kg
  End Tank final: 1033.0 kg
  Mass received: 882.4 kg
  Transfer efficiency: 97.83%

Conservation Check:
  Total initial mass: 1302.2 kg
  Total final mass: 1282.7 kg
  Mass conservation error: 1.499773%

Final End Tank State:
  Fill level: 79.1%
  Liquid mass: 1010.0 kg
  Vapor mass: 23.0 kg
  Pressure: 5.178 bar
  Temperature: 20.89 K

Generating plots...
  Saved: pressure_driven_tank_levels.png
  Saved: pressure_driven_pressures.png
  Saved: pressure_driven_temperatures.png
  Saved: pressure_driven_masses.png
  Saved: pressure_driven_dashboard.png

All plots saved to: C:\Projects\h2_twins\the_last\examples\output

----------------------------------------------------------------------

Press Enter to continue with pump-driven example...
======================================================================
 PUMP-DRIVEN TRANSFER SIMULATION
======================================================================

Scenario: Pump-Driven Transfer
  - Controlled mass flow via pump
  - No vaporizer needed
  - Different control strategy

Initial Conditions:
  Supply Tank:
    - Liquid mass: 1148.6 kg
    - Temperature: 21.0 K
  End Tank:
    - Liquid mass: 127.6 kg
    - Height: 5.7 m
  Transfer Mode: Pump-driven
    - Slow fill rate: 127.6 kg/hr
    - Fast fill rate: 510.5 kg/hr
    - Topping rate: 76.6 kg/hr

Running simulation...

Simulation Summary:
  Total time: 3600.0 s (60.00 min)
  Time steps: 432
  Success: True
  Message: The solver successfully reached the end of the integration interval.
  Function evaluations: 864

Mass Transfer:
  Supply Tank initial: 1151.6 kg
  Supply Tank final: 1024.0 kg
  Mass transferred: 127.6 kg
  End Tank initial: 150.6 kg
  End Tank final: 278.2 kg
  Mass received: 127.6 kg
  Transfer efficiency: 100.00%

Conservation Check:
  Total initial mass: 1302.2 kg
  Total final mass: 1302.2 kg
  Mass conservation error: 0.000000%

Final End Tank State:
  Fill level: 20.0%
  Liquid mass: 255.2 kg
  Vapor mass: 23.0 kg
  Pressure: 1.350 bar
  Temperature: 20.52 K

Generating plots...
  Saved: pump_driven_dashboard.png

All plots saved to: C:\Projects\h2_twins\the_last\examples\output

----------------------------------------------------------------------

======================================================================
 SCENARIO COMPARISON
======================================================================

This would compare:
  - Transfer time
  - Energy consumption
  - Pressure profiles
  - Venting losses

(Detailed comparison in future examples)

======================================================================
 EXAMPLES COMPLETED SUCCESSFULLY
======================================================================

Check the output directory for plots: C:\Projects\h2_twins\the_last\examples\output

Key takeaways:
  Simulation module integrates all physics calculations
  Visualization module creates publication-quality plots
  Mass conservation verified to <0.001% error
  Both pressure-driven and pump-driven modes working

more from output....

(venv) C:\Projects\h2_twins\the_last>python examples\complete_simulation.py > output.txt
C:\Projects\h2_twins\the_last\venv\Lib\site-packages\scipy\integrate\_ivp\common.py:357: RuntimeWarning: overflow encountered in multiply
  h_new = (y[ind] + new_factor * y_scale[ind]) - y[ind]


(venv) C:\Projects\h2_twins\the_last>